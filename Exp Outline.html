<!doctype html>
<html>
<head>
    <title>My experiment</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="jspsych-5.0.3/jspsych.js"></script>
    <script src="jspsych-5.0.3/plugins/jspsych-text.js"></script>
    <script src="jspsych-5.0.3/plugins/jspsych-single-stim.js"></script>
    <link href="jspsych-5.0.3/css/jspsych.css" rel="stylesheet" type="text/css"></link>
</head>
<body>
</body>
<script>

    /* define welcome message block */
    var welcome_block = {
        type: "text",
        text: "Welcome to the experiment. Press any key to begin."
    };


    /* define experiment instructions block */
    var instructions_block = {
        type: "text",
        text: "<p>Welcome to your new job as our building manager! </p>" +
        "<p>We've had some trouble hanging onto past managers, but I don't know why. </p>" +
        "<p>You get to travel to new cities, and the pay's great.  </p>" +
        "<div class='left center-content'><img src='img/city_1.png'></img>" +
        "<div class='center-content'><img src='img/city_2.png'></img>" +
        "<div class='right center-content'><img src='img/city_3.png'></img>",
        timing_post_trial: 2000
    };

    /* define town 1 message block */
    var town1_block = {
        type: "text",
        text: "<p>As the building manager, you'll be responsible for fixing anything that goes wrong in the houses. </p>" +
        "<p>Some houses are more likely to have certain issues. </p>" +
        "<p>Keep that in mind, since your tips will change depending on whether you fix the right problem. </p>" +
        "<p>Good luck on your first day, I know you'll do great! </p>",
    };

    /* define town 2 message block */
    var town2_block = {
        type: "text",
        text: "<p>You're doing a great job! </p>" +
        "<p>I think you're ready to meet some of our other residents. </p>" +
        "<p>You'll love the town I'm sending you to tomorrow! </p>",
    };

    /* define town 3 message block */
    var town3_block = {
        type: "text",
        text: "<p>You're a natural at this job!</p>" +
        "<p>You've been doing so well here that I think it's time you saw one of our other properties. </p>",
    };


    /* define test block */
    function experiment() {
        var img;
        var trial_num = 0;
        var phase_types = [practice, city1, city2, city3, final];
        var phase_index = -1;
        var counter = 0;
        var city1_stim = [
            {stimulus: 'img/c1b1notify.png'},
            {stimulus: 'img/c1b2notify.png'},
            {stimulus: 'img/c1b3notify.png'}
        ];
        var c1_trials = jsPsych.randomization.repeat(city1_stim, 8);
        var money_total = 0;
        var listening = false;
        var c1b1_rewards = {j:30, k:10, l:5};
        var c1b2_rewards = {j:10, k:30, l:5};
        var c1b3_rewards = {j:5, k:10, l:30};




        function repairReward(phase_types, rand_stim_order) {
            function notifyBlock(building) {
                if (building == 1) {                                 //how to make i=building
                    "<div class='center-content'><img src='img/c1b1notify.png'></img>",   // building = i
                }
                else if (building == 2) {
                    "<div class='center-content'><img src='img/c1b2notify.png'></img>",
                }
                else {
                    "<div class='center-content'><img src='img/c1b3notify.png'></img>",
                }
            }

            listening = true;
            window.onkeydown = function (event) {
                if (event.keyCode === 74) {
                    money_total += c1b1_rewards.j;
                }
                else if (event.keyCode === 75) {
                    money_total += c1b1_rewards.k;
                }
                else if (event.keyCode === 76) {
                    money_total += c1b1_rewards.l;
                }
            }
            listening = false;
            "<div class='center-content'><img src='img/city_1.png'></img>" //notifyimage hidden, replace image src
            for (var i = 0; i < rand_stim_order.length; i++) {   //move to end?
                notify_block(i)
            }


        }
    }





    /* create experiment timeline array */
    var timeline = [];
    timeline.push(welcome_block);
    timeline.push(instructions_block);
    timeline.push(town1_block);
    timeline.push(test_block);

    /* start the experiment */
    jsPsych.init({
        timeline: timeline,
        on_finish: function () {
            jsPsych.data.displayData();
        }
    })


</script>
</html>
